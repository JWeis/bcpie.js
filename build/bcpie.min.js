function theme(e,t){defaults={},e.data(bc.settingsAttr,$.extend({},defaults,t));var t=e.data(bc.settingsAttr);$("link").filter(function(){return $(this).attr("href").toLowerCase().indexOf(".css")>-1}).not(function(){return $(this).attr("href").toLowerCase().indexOf("modulestylesheets.css")>-1||$(this).attr("href").toLowerCase().indexOf("theme.css")>-1}).remove()}var doc=document,body=$(doc.body),win=window,bcpie={};bcpie={versions:{bcpieSDK:"2015.01.25"},api:{token:function(){return"undefined"!=typeof $.cookie("access_token")?$.cookie("access_token"):$.cookie("access_token",window.location.hash.replace("#access_token=",""))},data:{place:function(e,t){e=1===e.length&&e.is("form")?form.find("input,textarea,select,[data-name]").not("[data-noplace]"):e.not("[data-noplace]"),"string"==typeof t&&(t=$.parseJSON(t));for(key in t){var n=t[key],i=n;if("string"==typeof n&&(i=n.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(t)})),field=e.filter('[name="'+key+'"]').not("[data-noplace]"),element=e.filter('[data-name="'+key+'"]').not("[data-noplace]"),"undefined"!=typeof element&&element.text(i),"undefined"!=typeof field)if(field.is("input[type=radio]"))e.filter('[name="'+key+'"]').filter(function(){return $(this).is('[value="'+i+'"]')}).attr("checked","checked").prop("checked",!0);else if(field.is("input[type=checkbox]")){i=i.split(",");for(var a=0;a<i.length;a++)e.filter('[name="'+key+'"]').filter('[value="'+i[a]+'"]').attr("checked","checked").prop("checked",!0)}else field.is("input[type=text],textarea")&&field.val(i)}}},file:{get:function(e){return"undefined"!=typeof e&&e.length>1?("/"===e.charAt(0)&&e.slice(1,e.length-1),"/"===e.charAt(e.length-1)&&e.slice(0,-1),$.ajax({url:"/api/v2/admin/sites/current/storage/"+e,type:"GET",connection:"keep-alive",contentType:"application/json",headers:{Authorization:bcpie.api.token()},async:!1}).responseText):"no filename provided"},save:function(e,t){return"/"===e.charAt(0)&&e.slice(1,e.length-1),"/"===e.charAt(e.length-1)&&e.slice(0,-1),$.ajax({url:"/api/v2/admin/sites/current/storage/"+e+"?version=draft-publish",type:"PUT",headers:{Authorization:bcpie.api.token()},contentType:"application/octet-stream",async:!1,data:t,processData:!1})},"delete":function(e){return"/"===e.charAt(0)&&e.slice(1,e.length-1),"/"===e.charAt(e.length-1)&&e.slice(0,-1),$.ajax({url:"/api/v2/admin/sites/current/storage/"+e,type:"DELETE",headers:{Authorization:bcpie.api.token()}})}},webapp:{item:{get:function(e,t){return $.ajax({url:"/api/v2/admin/sites/current/webapps/"+e+"/items/"+t,headers:{Authorization:bcpie.api.token()},contentType:"application/json",async:!1}).responseJSON},place:function(e,t,n,i){var a=bcpie.api.webapp.item.get(t,n);bcpie.api.data.place(e,a),bcpie.api.data.place(e,a.fields),"undefined"!=typeof i&&i(a)},save:function(e,t,n){var i,a="/api/v2/admin/sites/current/webapps/"+t+"/items",r="POST",o=e.serializeObject();$.ajax({url:"/api/v2/admin/sites/current/webapps/"+t+"/fields",type:"get",async:!1,contentType:"application/json",headers:{Authorization:bcpie.api.token()}}).done(function(e){i={name:"",releaseDate:moment().subtract(12,"hour").format("YYYY-MM-DD"),expiryDate:"9999-01-01",enabled:!0,country:"US",fields:{}},allFields={name:"",weight:0,releaseDate:moment().subtract(12,"hour").format("YYYY-MM-DD"),expiryDate:"9999-01-01",enabled:!0,slug:"",description:"",roleId:null,submittedBy:-1,templateId:-1,address:"",city:"",state:"",zipCode:"",country:"",fields:{}},"undefined"!=typeof n&&""!==n&&(a=a+"/"+n,r="PUT",delete i.releaseDate);for(var t=0;t<e.items.length;t++)"undefined"!=typeof o[e.items[t].name]&&(i.fields[e.items[t].name]="");for(key in o)"undefined"!=typeof allFields[key]?i[key]=o[key]:"undefined"!=typeof i.fields[key]&&(i.fields[key]=o[key]);$.ajax({url:a,type:r,connection:"keep-alive",contentType:"application/json",headers:{Authorization:bcpie.api.token()},data:JSON.stringify(i),async:!1})})},"delete":function(e,t){$.ajax({url:"/api/v2/admin/sites/current/webapps/"+e+"/items/"+t,type:"DELETE",connection:"keep-alive",contentType:"application/json",headers:{Authorization:bcpie.api.token()}})}}}},frontend:{webapp:{item:{"new":function(e,t,n,i){$.ajax({url:"/CustomContentProcess.aspx?CCID="+e+"&OTYPE=1",type:"POST",data:t,success:function(e){"undefined"!=typeof n&&n(e)},error:function(e){"undefined"!=typeof i&&i(e)}})},update:function(){}},search:function(e,t,n,i){var a=$.ajax({url:"/Default.aspx?CCID="+e+"&FID="+t+"&ExcludeBoolFalse=True&PageID="+n,type:"POST",data:i,async:!1});return $(a.responseText).find(".webappsearchresults").children()}},crm:{update:function(e,t,n){$.ajax({url:"/MemberProcess.aspx",type:"POST",data:e,success:function(e){"undefined"!=typeof t&&t(e)},error:function(e){"undefined"!=typeof n&&n(e)}})}}},utils:{_jsonify_brace:/^[{\[]/,_jsonify_token:/[^,:{}\[\]]+/g,_jsonify_quote:/^['"](.*)['"]$/,_jsonify_escap:/(["])/g,serializeObject:function(e){for(var t={},n=e.serializeArray(),i=0;i<n.length;i++)void 0!==t[n[i].name]?(t[n[i].name].push||(t[n[i].name]=[t[n[i].name]]),t[n[i].name].push(n[i].value||"")):t[n[i].name]=n[i].value||"";return t},escape:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},jsonify:function(e){return e=$.trim(e),bcpie.utils._jsonify_brace.test(e)===!1&&(e="{"+e+"}"),e.replace(bcpie.utils._jsonify_token,function(e){return e=$.trim(e),""===e||"true"===e||"false"===e||"null"===e||!isNaN(parseFloat(e))&&isFinite(e)?e:'"'+e.replace(bcpie.utils._jsonify_quote,"$1").replace(bcpie.utils._jsonify_escap,"\\$1")+'"'})},guid:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},trick:function(e){function t(e){switch(e.toLowerCase()){case"true":return!0;case"false":return!1;default:return e}}var n,i,a,r,o,s;if(n=$(doc).find("[data-bcpie-"+e.toLowerCase()+"]"),n.length>0)for(var c=0;c<n.length;c++){if(a={},n.cur=$(n[c]),i=n.cur.data("bcpie-"+e.toLowerCase()),"string"===$.type(i)&&i.indexOf(":")>-1)if(i.indexOf(";")>-1){i=i.split(";");for(var p=0;p<i.length;p++)r=i[p].split(":"),a[$.trim(r[0])]=t($.trim(r.slice(1).join(":")))}else r=i.split(":"),a[$.trim(r[0])]=t($.trim(r.slice(1).join(":")));o={},functions[e](n.cur,s)}}},bcpie.versions.theme="2015.01.25",bcpie.trick("theme");